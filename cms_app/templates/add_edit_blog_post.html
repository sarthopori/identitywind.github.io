{% extends "base.html" %}
{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="cms-container">
    <h2>{{ title }}</h2>

    <form method="POST" enctype="multipart/form-data" action="{{ url_for('add_blog_post') if not post else url_for('edit_blog_post', item_id=post_id) }}">
        <div class="form-group">
            <label for="title">Post Title:</label>
            <input type="text" id="title" name="title" value="{{ post.title if post else '' }}" required>
        </div>
        <div class="form-group">
            <label for="author">Author:</label>
            <input type="text" id="author" name="author" value="{{ post.author if post else '' }}" required>
        </div>
        <div class="form-group">
            <label for="date">Date (e.g., July 30, 2025):</label>
            <input type="text" id="date" name="date" value="{{ post.date if post else current_date }}" required>
            <small>Format: Month Day, Year (e.g., July 30, 2025)</small>
        </div>
        <div class="form-group">
            <label for="image">Post Banner Image:</label>
            <input type="file" id="image" name="image" accept="image/*">
            {% if post and post.image %}
                <p>Current Image: <img src="{{ url_for('serve_content_image', filename='blog/' + post.image) }}" alt="Current Blog Banner" style="max-width: 200px; height: auto; margin-top: 10px; display: block; border: 1px solid #ddd;"></p>
                <p>Filename: {{ post.image }}</p>
            {% endif %}
            <small>Upload a new image to replace the current one.</small>
        </div>
        <div class="form-group">
            <label for="excerpt">Excerpt (short summary):</label>
            <textarea id="excerpt" name="excerpt" rows="3" required>{{ post.excerpt if post else '' }}</textarea>
            <small>A brief summary shown on the blog listing page.</small>
        </div>
        <div class="form-group">
            <label for="content">Full Post Content (Markdown):</label>
            <textarea id="content" name="content" rows="15" required>{{ current_markdown_content if post else '' }}</textarea>
            <small>Write your blog post content using Markdown syntax.</small>
        </div>
        
        <button type="submit" class="btn-submit">Save Blog Post</button>
        <a href="{{ url_for('manage_blog_posts') }}" class="btn-cancel">Cancel</a>
    </form>
</div>
{% endblock %}